<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Multivariate Statistics and Principle Components Analysis | We R Under Way: A Data Science Portfolio</title>
  <meta name="description" content="Just some of my adventures so far in the lands of environmental data. Warning: I can’t help adding nerd jokes, so pun-ish me." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Multivariate Statistics and Principle Components Analysis | We R Under Way: A Data Science Portfolio" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Just some of my adventures so far in the lands of environmental data. Warning: I can’t help adding nerd jokes, so pun-ish me." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Multivariate Statistics and Principle Components Analysis | We R Under Way: A Data Science Portfolio" />
  
  <meta name="twitter:description" content="Just some of my adventures so far in the lands of environmental data. Warning: I can’t help adding nerd jokes, so pun-ish me." />
  

<meta name="author" content="Kaydee S. Barker" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-regressions-quadratic-fits-residuals-and-spatial.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.0/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.0/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">We R Under Way: A Data Science Portfolio</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="2" data-path="interactive-graphing-discharge-of-the-poudre-river.html"><a href="interactive-graphing-discharge-of-the-poudre-river.html"><i class="fa fa-check"></i><b>2</b> Interactive Graphing: Discharge of the Poudre River<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="interactive-graphing-discharge-of-the-poudre-river.html"><a href="interactive-graphing-discharge-of-the-poudre-river.html#background-on-the-poudre-river"><i class="fa fa-check"></i><b>2.1</b> Background on the Poudre River<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="interactive-graphing-discharge-of-the-poudre-river.html"><a href="interactive-graphing-discharge-of-the-poudre-river.html#interactive-discharge-chart"><i class="fa fa-check"></i><b>2.2</b> Interactive Discharge Chart<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="looking-at-effects-of-fire-on-vegetation.html"><a href="looking-at-effects-of-fire-on-vegetation.html"><i class="fa fa-check"></i><b>3</b> Looking at Effects of Fire on Vegetation<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="looking-at-effects-of-fire-on-vegetation.html"><a href="looking-at-effects-of-fire-on-vegetation.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="looking-at-effects-of-fire-on-vegetation.html"><a href="looking-at-effects-of-fire-on-vegetation.html#what-is-the-correlation-between-ndvi-and-ndmi"><i class="fa fa-check"></i><b>3.2</b> What is the correlation between NDVI and NDMI?<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="looking-at-effects-of-fire-on-vegetation.html"><a href="looking-at-effects-of-fire-on-vegetation.html#what-month-is-the-greenest-month-on-average"><i class="fa fa-check"></i><b>3.3</b> What month is the greenest month on average?<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="looking-at-effects-of-fire-on-vegetation.html"><a href="looking-at-effects-of-fire-on-vegetation.html#what-month-is-the-snowiest-on-average"><i class="fa fa-check"></i><b>3.4</b> What month is the snowiest on average?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="fire-effects-on-fish-populations.html"><a href="fire-effects-on-fish-populations.html"><i class="fa fa-check"></i><b>4</b> Fire Effects on Fish Populations<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="fire-effects-on-fish-populations.html"><a href="fire-effects-on-fish-populations.html#pre-versus-post-fire-fish-length-and-mass"><i class="fa fa-check"></i><b>4.1</b> Pre versus post fire fish length and mass<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="fire-effects-on-fish-populations.html"><a href="fire-effects-on-fish-populations.html#linear-regression-of-fish-mass-vs.-length-for-before-and-after-the-fire"><i class="fa fa-check"></i><b>4.2</b> Linear regression of fish mass vs. length for before and after the fire<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="extracting-and-visualizing-meteorological-data.html"><a href="extracting-and-visualizing-meteorological-data.html"><i class="fa fa-check"></i><b>5</b> Extracting and Visualizing Meteorological Data<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="extracting-and-visualizing-meteorological-data.html"><a href="extracting-and-visualizing-meteorological-data.html#extract-the-meteorological-data-urls."><i class="fa fa-check"></i><b>5.1</b> Extract the meteorological data URLs.<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="extracting-and-visualizing-meteorological-data.html"><a href="extracting-and-visualizing-meteorological-data.html#download-the-meteorological-data-from-the-url"><i class="fa fa-check"></i><b>5.2</b> Download the meteorological data from the URL<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="extracting-and-visualizing-meteorological-data.html"><a href="extracting-and-visualizing-meteorological-data.html#write-a-custom-function-to-read-in-the-data-and-append-a-site-column-to-the-data"><i class="fa fa-check"></i><b>5.3</b> Write a custom function to read in the data and append a site column to the data<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="extracting-and-visualizing-meteorological-data.html"><a href="extracting-and-visualizing-meteorological-data.html#use-the-map-function-to-read-in-both-meteorological-files"><i class="fa fa-check"></i><b>5.4</b> Use the <code>map</code> function to read in both meteorological files<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="extracting-and-visualizing-meteorological-data.html"><a href="extracting-and-visualizing-meteorological-data.html#make-a-line-plot-of-mean-temp-by-year-by-site"><i class="fa fa-check"></i><b>5.5</b> Make a line plot of mean temp by year by site<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="extracting-and-visualizing-meteorological-data.html"><a href="extracting-and-visualizing-meteorological-data.html#write-a-function-that-makes-line-plots-of-monthly-average-temperature-at-each-site-for-a-given-year.-use-a-for-loop-to-make-these-plots-for-2005-to-2010."><i class="fa fa-check"></i><b>5.6</b> Write a function that makes line plots of monthly average temperature at each site for a given year. Use a for loop to make these plots for 2005 to 2010.<span></span></a></li>
<li class="chapter" data-level="5.7" data-path="extracting-and-visualizing-meteorological-data.html"><a href="extracting-and-visualizing-meteorological-data.html#make-a-plot-of-average-daily-precipitation-by-day-of-year-averaged-across-all-available-years"><i class="fa fa-check"></i><b>5.7</b> Make a plot of average daily precipitation by day of year (averaged across all available years)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html"><i class="fa fa-check"></i><b>6</b> Spatial Analysis in R<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#loading-in-data"><i class="fa fa-check"></i><b>6.1</b> Loading in data<span></span></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#first-download-and-then-specifically-grab-the-locus-or-site-lat-longs"><i class="fa fa-check"></i><b>6.1.1</b> First download and then specifically grab the locus (or site lat longs)<span></span></a></li>
<li class="chapter" data-level="6.1.2" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#convert-to-spatial-data"><i class="fa fa-check"></i><b>6.1.2</b> Convert to spatial data<span></span></a></li>
<li class="chapter" data-level="6.1.3" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#subset-to-only-minnesota"><i class="fa fa-check"></i><b>6.1.3</b> Subset to only Minnesota<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#part-one"><i class="fa fa-check"></i><b>6.2</b> Part one<span></span></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#show-a-map-outline-of-iowa-and-illinois-similar-to-minnesota-map-upstream"><i class="fa fa-check"></i><b>6.2.1</b> Show a map outline of Iowa and Illinois (similar to Minnesota map upstream)<span></span></a></li>
<li class="chapter" data-level="6.2.2" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#subset-lagos-data-to-these-sites-how-many-sites-are-in-illinois-and-iowa-combined-how-does-this-compare-to-minnesota"><i class="fa fa-check"></i><b>6.2.2</b> Subset LAGOS data to these sites, how many sites are in Illinois and Iowa combined? How does this compare to Minnesota?<span></span></a></li>
<li class="chapter" data-level="6.2.3" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#what-is-the-distribution-of-lake-size-in-iowa-vs.-minnesota"><i class="fa fa-check"></i><b>6.2.3</b> What is the distribution of lake size in Iowa vs. Minnesota?<span></span></a></li>
<li class="chapter" data-level="6.2.4" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#make-an-interactive-plot-of-lakes-in-iowa-and-illinois-and-color-them-by-lake-area-in-hectares"><i class="fa fa-check"></i><b>6.2.4</b> Make an interactive plot of lakes in Iowa and Illinois and color them by lake area in hectares<span></span></a></li>
<li class="chapter" data-level="6.2.5" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#what-other-data-sources-might-we-use-to-understand-how-reservoirs-and-natural-lakes-vary-in-size-in-these-three-states"><i class="fa fa-check"></i><b>6.2.5</b> What other data sources might we use to understand how reservoirs and natural lakes vary in size in these three states?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#part-two"><i class="fa fa-check"></i><b>6.3</b> Part two<span></span></a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#subsets"><i class="fa fa-check"></i><b>6.3.1</b> Subsets<span></span></a></li>
<li class="chapter" data-level="6.3.2" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#mean-chlorophyll-a-map"><i class="fa fa-check"></i><b>6.3.2</b> Mean Chlorophyll A map<span></span></a></li>
<li class="chapter" data-level="6.3.3" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#what-is-the-correlation-between-secchi-disk-depth-and-chlorophyll-a-for-sites-with-at-least-200-observations"><i class="fa fa-check"></i><b>6.3.3</b> What is the correlation between Secchi Disk Depth and Chlorophyll a for sites with at least 200 observations?<span></span></a></li>
<li class="chapter" data-level="6.3.4" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#what-states-have-the-most-data"><i class="fa fa-check"></i><b>6.3.4</b> What states have the most data?<span></span></a></li>
<li class="chapter" data-level="6.3.5" data-path="spatial-analysis-in-r.html"><a href="spatial-analysis-in-r.html#is-there-a-spatial-pattern-in-secchi-disk-depth-for-lakes-with-at-least-200-observations"><i class="fa fa-check"></i><b>6.3.5</b> Is there a spatial pattern in Secchi disk depth for lakes with at least 200 observations?<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-regressions-quadratic-fits-residuals-and-spatial.html"><a href="linear-regressions-quadratic-fits-residuals-and-spatial.html"><i class="fa fa-check"></i><b>7</b> Linear Regressions, Quadratic Fits, Residuals, and Spatial<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="linear-regressions-quadratic-fits-residuals-and-spatial.html"><a href="linear-regressions-quadratic-fits-residuals-and-spatial.html#weather-data-analysis"><i class="fa fa-check"></i><b>7.1</b> Weather Data Analysis<span></span></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="linear-regressions-quadratic-fits-residuals-and-spatial.html"><a href="linear-regressions-quadratic-fits-residuals-and-spatial.html#load-the-prism-daily-maximum-temperatures"><i class="fa fa-check"></i><b>7.1.1</b> Load the PRISM daily maximum temperatures<span></span></a></li>
<li class="chapter" data-level="7.1.2" data-path="linear-regressions-quadratic-fits-residuals-and-spatial.html"><a href="linear-regressions-quadratic-fits-residuals-and-spatial.html#download-nass-corn-yield-data"><i class="fa fa-check"></i><b>7.1.2</b> Download NASS corn yield data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="linear-regressions-quadratic-fits-residuals-and-spatial.html"><a href="linear-regressions-quadratic-fits-residuals-and-spatial.html#extract-winneshiek-county-corn-yields-fit-a-linear-time-trend-make-a-plot.-is-there-a-significant-time-trend"><i class="fa fa-check"></i><b>7.2</b> Extract Winneshiek County corn yields, fit a linear time trend, make a plot. Is there a significant time trend?<span></span></a></li>
<li class="chapter" data-level="7.3" data-path="linear-regressions-quadratic-fits-residuals-and-spatial.html"><a href="linear-regressions-quadratic-fits-residuals-and-spatial.html#fit-a-quadratic-time-trend-i.e.-year-year2-and-make-a-plot.-is-there-evidence-for-slowing-yield-growth"><i class="fa fa-check"></i><b>7.3</b> Fit a quadratic time trend (i.e., year + year^2) and make a plot. Is there evidence for slowing yield growth?<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="linear-regressions-quadratic-fits-residuals-and-spatial.html"><a href="linear-regressions-quadratic-fits-residuals-and-spatial.html#time-series-lets-analyze-the-relationship-between-temperature-and-yields-for-the-winneshiek-county-time-series.-use-data-on-yield-and-summer-avg-tmax.-is-adding-year-or-tmax2-to-your-model-helpful-make-a-plot-and-interpret-the-results."><i class="fa fa-check"></i><b>7.4</b> Time Series: Let’s analyze the relationship between temperature and yields for the Winneshiek County time series. Use data on yield and summer avg Tmax. Is adding year or Tmax^2 to your model helpful? Make a plot and interpret the results.<span></span></a></li>
<li class="chapter" data-level="7.5" data-path="linear-regressions-quadratic-fits-residuals-and-spatial.html"><a href="linear-regressions-quadratic-fits-residuals-and-spatial.html#cross-section-analyze-the-relationship-between-temperature-and-yield-across-all-counties-in-2018.-is-there-a-relationship-interpret-the-results."><i class="fa fa-check"></i><b>7.5</b> Cross-Section: Analyze the relationship between temperature and yield across all counties in 2018. Is there a relationship? Interpret the results.<span></span></a></li>
<li class="chapter" data-level="7.6" data-path="linear-regressions-quadratic-fits-residuals-and-spatial.html"><a href="linear-regressions-quadratic-fits-residuals-and-spatial.html#panel-one-way-to-leverage-multiple-time-series-is-to-group-all-data-into-what-is-called-a-panel-regression."><i class="fa fa-check"></i><b>7.6</b> Panel: One way to leverage multiple time series is to group all data into what is called a “panel” regression.<span></span></a></li>
<li class="chapter" data-level="7.7" data-path="linear-regressions-quadratic-fits-residuals-and-spatial.html"><a href="linear-regressions-quadratic-fits-residuals-and-spatial.html#soybeans-download-nass-data-on-soybean-yields-and-explore-either-a-time-series-relationship-for-a-given-county-the-cross-sectional-relationship-for-a-given-year-or-a-panel-across-all-counties-and-years."><i class="fa fa-check"></i><b>7.7</b> Soybeans: Download NASS data on soybean yields and explore either a time series relationship for a given county, the cross-sectional relationship for a given year, or a panel across all counties and years.<span></span></a></li>
<li class="chapter" data-level="7.8" data-path="linear-regressions-quadratic-fits-residuals-and-spatial.html"><a href="linear-regressions-quadratic-fits-residuals-and-spatial.html#bonus-find-a-package-to-make-a-county-map-of-iowa-displaying-some-sort-of-information-about-yields-or-weather.-interpret-your-map."><i class="fa fa-check"></i><b>7.8</b> Bonus: Find a package to make a county map of Iowa displaying some sort of information about yields or weather. Interpret your map.<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="multivariate-statistics-and-principle-components-analysis.html"><a href="multivariate-statistics-and-principle-components-analysis.html"><i class="fa fa-check"></i><b>8</b> Multivariate Statistics and Principle Components Analysis<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="multivariate-statistics-and-principle-components-analysis.html"><a href="multivariate-statistics-and-principle-components-analysis.html#scatterplot-matrix-of-variables"><i class="fa fa-check"></i><b>8.1</b> Scatterplot matrix of variables<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="multivariate-statistics-and-principle-components-analysis.html"><a href="multivariate-statistics-and-principle-components-analysis.html#correlation-matrix"><i class="fa fa-check"></i><b>8.2</b> Correlation matrix<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="multivariate-statistics-and-principle-components-analysis.html"><a href="multivariate-statistics-and-principle-components-analysis.html#calculate-variances"><i class="fa fa-check"></i><b>8.3</b> Calculate variances<span></span></a></li>
<li class="chapter" data-level="8.4" data-path="multivariate-statistics-and-principle-components-analysis.html"><a href="multivariate-statistics-and-principle-components-analysis.html#standardizing-variables"><i class="fa fa-check"></i><b>8.4</b> Standardizing variables<span></span></a></li>
<li class="chapter" data-level="8.5" data-path="multivariate-statistics-and-principle-components-analysis.html"><a href="multivariate-statistics-and-principle-components-analysis.html#pca-on-standardized-data"><i class="fa fa-check"></i><b>8.5</b> PCA on standardized data<span></span></a></li>
<li class="chapter" data-level="8.6" data-path="multivariate-statistics-and-principle-components-analysis.html"><a href="multivariate-statistics-and-principle-components-analysis.html#pca-on-raw-data"><i class="fa fa-check"></i><b>8.6</b> PCA on raw data<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">We R Under Way: A Data Science Portfolio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multivariate-statistics-and-principle-components-analysis" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Multivariate Statistics and Principle Components Analysis<a href="multivariate-statistics-and-principle-components-analysis.html#multivariate-statistics-and-principle-components-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>A lot of data that we try to analyze is <em>multivariate</em>, meaning that the data has multiple records or observations with multiple variables. There are various ways to look at this type of data and describe associations of variables. We may describe associations through <em>covariance</em> or a <em>correlation coefficient</em>. <em>Principle Components Analysis (PCA)</em> is a useful tool for looking at correlation that uses orthogonal transformation to convert observations with potentially correlated variables into a set of values of linearly uncorrelated variables (called principal components). In order to explore PCA as a tool, we looked at wine and how variables of wine are correlated with one another.</p>
<p>Data and assignment provided by Dr. Michael Lefsky of Colorado State University.</p>
<div id="scatterplot-matrix-of-variables" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Scatterplot matrix of variables<a href="multivariate-statistics-and-principle-components-analysis.html#scatterplot-matrix-of-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a scatterplot of variables 2 to 6 where each cultivar is shown in a different color</span></span>
<span id="cb126-2"><a href="multivariate-statistics-and-principle-components-analysis.html#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(wine[,<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">main =</span> <span class="st">&quot;Wine Data -- 3 cultivars&quot;</span>,</span>
<span id="cb126-3"><a href="multivariate-statistics-and-principle-components-analysis.html#cb126-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green3&quot;</span>, <span class="st">&quot;blue&quot;</span>)[<span class="fu">unclass</span>(wine<span class="sc">$</span>cultivar)])</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-44"></span>
<img src="Rportfolio-bookdown_files/figure-html/unnamed-chunk-44-1.png" alt="Scatterplot matrix demonstrating the relationships between five variables for three wine cultivars. Alcohol, malic acid (malic), ash, alkalinity of ash (alk), and magnesium (Mg) are plotted together on both x and y axes for cultivar 1 (red), cultivar 2 (green), and cultivar 3 (blue). Groupings demonstrate association between variables." width="672" />
<p class="caption">
Figure 8.1: Scatterplot matrix demonstrating the relationships between five variables for three wine cultivars. Alcohol, malic acid (malic), ash, alkalinity of ash (alk), and magnesium (Mg) are plotted together on both x and y axes for cultivar 1 (red), cultivar 2 (green), and cultivar 3 (blue). Groupings demonstrate association between variables.
</p>
</div>
<p>From the above plot, alcohol and alkalinity don’t seem to have a very strong linear relationship, but it appears that the weak correlation is negative, with alkalinity decreasing as alcohol increases and vice versa. Ash and alkalinity seem to have a slightly stronger linear relationship that is positive; as ash increases, so does alkalinity, and vice versa.</p>
</div>
<div id="correlation-matrix" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Correlation matrix<a href="multivariate-statistics-and-principle-components-analysis.html#correlation-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a correlation matrix between variables 2 to 14</span></span>
<span id="cb127-2"><a href="multivariate-statistics-and-principle-components-analysis.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(wine[,<span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>]) </span></code></pre></div>
<pre><code>##                 alcohol       malic          ash         alk          Mg
## alcohol      1.00000000  0.09439694  0.211544596 -0.31023514  0.27079823
## malic        0.09439694  1.00000000  0.164045470  0.28850040 -0.05457510
## ash          0.21154460  0.16404547  1.000000000  0.44336719  0.28658669
## alk         -0.31023514  0.28850040  0.443367187  1.00000000 -0.08333309
## Mg           0.27079823 -0.05457510  0.286586691 -0.08333309  1.00000000
## totphen      0.28910112 -0.33516700  0.128979538 -0.32111332  0.21440123
## flavan       0.23681493 -0.41100659  0.115077279 -0.35136986  0.19578377
## nonflavphen -0.15592947  0.29297713  0.186230446  0.36192172 -0.25629405
## proantho     0.13669791 -0.22074619  0.009651935 -0.19732684  0.23644061
## color        0.54636420  0.24898534  0.258887259  0.01873198  0.19995001
## hue         -0.07174720 -0.56129569 -0.074666889 -0.27395522  0.05539820
## OD           0.07234319 -0.36871043  0.003911231 -0.27676855  0.06600394
## proline      0.64372004 -0.19201056  0.223626264 -0.44059693  0.39335085
##                 totphen     flavan nonflavphen     proantho       color
## alcohol      0.28910112  0.2368149  -0.1559295  0.136697912  0.54636420
## malic       -0.33516700 -0.4110066   0.2929771 -0.220746187  0.24898534
## ash          0.12897954  0.1150773   0.1862304  0.009651935  0.25888726
## alk         -0.32111332 -0.3513699   0.3619217 -0.197326836  0.01873198
## Mg           0.21440123  0.1957838  -0.2562940  0.236440610  0.19995001
## totphen      1.00000000  0.8645635  -0.4499353  0.612413084 -0.05513642
## flavan       0.86456350  1.0000000  -0.5378996  0.652691769 -0.17237940
## nonflavphen -0.44993530 -0.5378996   1.0000000 -0.365845099  0.13905701
## proantho     0.61241308  0.6526918  -0.3658451  1.000000000 -0.02524993
## color       -0.05513642 -0.1723794   0.1390570 -0.025249931  1.00000000
## hue          0.43368134  0.5434786  -0.2626396  0.295544253 -0.52181319
## OD           0.69994936  0.7871939  -0.5032696  0.519067096 -0.42881494
## proline      0.49811488  0.4941931  -0.3113852  0.330416700  0.31610011
##                     hue           OD    proline
## alcohol     -0.07174720  0.072343187  0.6437200
## malic       -0.56129569 -0.368710428 -0.1920106
## ash         -0.07466689  0.003911231  0.2236263
## alk         -0.27395522 -0.276768549 -0.4405969
## Mg           0.05539820  0.066003936  0.3933508
## totphen      0.43368134  0.699949365  0.4981149
## flavan       0.54347857  0.787193902  0.4941931
## nonflavphen -0.26263963 -0.503269596 -0.3113852
## proantho     0.29554425  0.519067096  0.3304167
## color       -0.52181319 -0.428814942  0.3161001
## hue          1.00000000  0.565468293  0.2361834
## OD           0.56546829  1.000000000  0.3127611
## proline      0.23618345  0.312761075  1.0000000</code></pre>
<p>Correlation matrix for variables for wine, including alcohol, malic acid (malic), ash, alkalinity of ash (alk), magnesium (Mg), total phenol (totphen), flavonoids (flavan), nonflavanoid phenols (nonflavphen), proanthocyanins (proantho), color intensity (color), hue, OD280/OD315 of diluted wines (OD), and proline.</p>
</div>
<div id="calculate-variances" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Calculate variances<a href="multivariate-statistics-and-principle-components-analysis.html#calculate-variances" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate variances for variables 2 to 14 for all variables together</span></span>
<span id="cb129-2"><a href="multivariate-statistics-and-principle-components-analysis.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(wine[,<span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>]) <span class="co"># the diagonal values in the matrix are variances</span></span></code></pre></div>
<pre><code>##                  alcohol        malic           ash          alk           Mg
## alcohol       0.65906233   0.08561131  0.0471151590   -0.8410929    3.1398781
## malic         0.08561131   1.24801540  0.0502770393    1.0763317   -0.8707795
## ash           0.04711516   0.05027704  0.0752646353    0.4062083    1.1229366
## alk          -0.84109290   1.07633171  0.4062082778   11.1526862   -3.9747604
## Mg            3.13987812  -0.87077953  1.1229365835   -3.9747604  203.9893354
## totphen       0.14688722  -0.23433772  0.0221455913   -0.6711491    1.9164699
## flavan        0.19203322  -0.45863037  0.0315347299   -1.1720828    2.7930870
## nonflavphen  -0.01575426   0.04073336  0.0063584714    0.1504219   -0.4555634
## proantho      0.06351752  -0.14114698  0.0015155780   -0.3771762    1.9328325
## color         1.02828254   0.64483818  0.1646543266    0.1450242    6.6205206
## hue          -0.01331344  -0.14332564 -0.0046821545   -0.2091181    0.1808513
## OD            0.04169782  -0.29244748  0.0007618358   -0.6562344    0.6693081
## proline     164.56718498 -67.54886657 19.3197390973 -463.3553450 1769.1586999
##                 totphen       flavan   nonflavphen     proantho        color
## alcohol      0.14688722   0.19203322  -0.015754260  0.063517520   1.02828254
## malic       -0.23433772  -0.45863037   0.040733362 -0.141146982   0.64483818
## ash          0.02214559   0.03153473   0.006358471  0.001515578   0.16465433
## alk         -0.67114915  -1.17208281   0.150421856 -0.377176220   0.14502419
## Mg           1.91646988   2.79308703  -0.455563385  1.932832476   6.62052061
## totphen      0.39168954   0.54047042  -0.035045125  0.219373345  -0.07999752
## flavan       0.54047042   0.99771867  -0.066867000  0.373147553  -0.39916863
## nonflavphen -0.03504512  -0.06686700   0.015488634 -0.026059868   0.04012051
## proantho     0.21937334   0.37314755  -0.026059868  0.327594668  -0.03350392
## color       -0.07999752  -0.39916863   0.040120510 -0.033503918   5.37444938
## hue          0.06203888   0.12408197  -0.007471177  0.038664565  -0.27650580
## OD           0.31102128   0.55826225  -0.044469244  0.210932940  -0.70581258
## proline     98.17105726 155.44749222 -12.203586301 59.554333778 230.76748014
##                      hue            OD     proline
## alcohol     -0.013313443  0.0416978226   164.56718
## malic       -0.143325638 -0.2924474830   -67.54887
## ash         -0.004682155  0.0007618358    19.31974
## alk         -0.209118054 -0.6562343681  -463.35535
## Mg           0.180851266  0.6693080683  1769.15870
## totphen      0.062038876  0.3110212785    98.17106
## flavan       0.124081969  0.5582622548   155.44749
## nonflavphen -0.007471177 -0.0444692440   -12.20359
## proantho     0.038664565  0.2109329398    59.55433
## color       -0.276505801 -0.7058125762   230.76748
## hue          0.052244961  0.0917662439    17.00022
## OD           0.091766244  0.5040864089    69.92753
## proline     17.000223386 69.9275255507 99166.71736</code></pre>
<p>By testing the variances of variables, we can look at whether they need to be standardized in order to get an accurate representation of variable influence in a PCA. In this case, we do need to standardize, because the variances are quite different between variables.</p>
</div>
<div id="standardizing-variables" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Standardizing variables<a href="multivariate-statistics-and-principle-components-analysis.html#standardizing-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You can standardize variables in R using the &quot;scale()&quot; function</span></span>
<span id="cb131-2"><a href="multivariate-statistics-and-principle-components-analysis.html#cb131-2" aria-hidden="true" tabindex="-1"></a>wine.standardized <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">scale</span>(wine[,<span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>]))</span>
<span id="cb131-3"><a href="multivariate-statistics-and-principle-components-analysis.html#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="multivariate-statistics-and-principle-components-analysis.html#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(wine.standardized, mean) <span class="co"># for calculating mean of all variables</span></span></code></pre></div>
<pre><code>##       alcohol         malic           ash           alk            Mg 
## -8.591766e-16 -6.776446e-17  8.045176e-16 -7.720494e-17 -4.073935e-17 
##       totphen        flavan   nonflavphen      proantho         color 
## -1.395560e-17  6.958263e-17 -1.042186e-16 -1.221369e-16  3.649376e-17 
##           hue            OD       proline 
##  2.093741e-16  3.003459e-16 -1.034429e-16</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(wine.standardized, var) <span class="co"># for calculating variance of all variables</span></span></code></pre></div>
<pre><code>##     alcohol       malic         ash         alk          Mg     totphen 
##           1           1           1           1           1           1 
##      flavan nonflavphen    proantho       color         hue          OD 
##           1           1           1           1           1           1 
##     proline 
##           1</code></pre>
</div>
<div id="pca-on-standardized-data" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> PCA on standardized data<a href="multivariate-statistics-and-principle-components-analysis.html#pca-on-standardized-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Perform PCA on standardized data</span></span>
<span id="cb135-2"><a href="multivariate-statistics-and-principle-components-analysis.html#cb135-2" aria-hidden="true" tabindex="-1"></a>wine.pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(wine.standardized)</span>
<span id="cb135-3"><a href="multivariate-statistics-and-principle-components-analysis.html#cb135-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-4"><a href="multivariate-statistics-and-principle-components-analysis.html#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print summary of the PCA</span></span>
<span id="cb135-5"><a href="multivariate-statistics-and-principle-components-analysis.html#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wine.pca)</span></code></pre></div>
<pre><code>## Importance of components:
##                          PC1    PC2    PC3     PC4     PC5     PC6     PC7
## Standard deviation     2.169 1.5802 1.2025 0.95863 0.92370 0.80103 0.74231
## Proportion of Variance 0.362 0.1921 0.1112 0.07069 0.06563 0.04936 0.04239
## Cumulative Proportion  0.362 0.5541 0.6653 0.73599 0.80162 0.85098 0.89337
##                            PC8     PC9   PC10    PC11    PC12    PC13
## Standard deviation     0.59034 0.53748 0.5009 0.47517 0.41082 0.32152
## Proportion of Variance 0.02681 0.02222 0.0193 0.01737 0.01298 0.00795
## Cumulative Proportion  0.92018 0.94240 0.9617 0.97907 0.99205 1.00000</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">screeplot</span>(wine.pca)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-48"></span>
<img src="Rportfolio-bookdown_files/figure-html/unnamed-chunk-48-1.png" alt="Screeplot summary of variances in standardized data." width="672" />
<p class="caption">
Figure 8.2: Screeplot summary of variances in standardized data.
</p>
</div>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the loadings from the standardized data</span></span>
<span id="cb138-2"><a href="multivariate-statistics-and-principle-components-analysis.html#cb138-2" aria-hidden="true" tabindex="-1"></a>wine.pca<span class="sc">$</span>rotation</span></code></pre></div>
<pre><code>##                      PC1          PC2         PC3         PC4         PC5
## alcohol     -0.144329395  0.483651548 -0.20738262  0.01785630 -0.26566365
## malic        0.245187580  0.224930935  0.08901289 -0.53689028  0.03521363
## ash          0.002051061  0.316068814  0.62622390  0.21417556 -0.14302547
## alk          0.239320405 -0.010590502  0.61208035 -0.06085941  0.06610294
## Mg          -0.141992042  0.299634003  0.13075693  0.35179658  0.72704851
## totphen     -0.394660845  0.065039512  0.14617896 -0.19806835 -0.14931841
## flavan      -0.422934297 -0.003359812  0.15068190 -0.15229479 -0.10902584
## nonflavphen  0.298533103  0.028779488  0.17036816  0.20330102 -0.50070298
## proantho    -0.313429488  0.039301722  0.14945431 -0.39905653  0.13685982
## color        0.088616705  0.529995672 -0.13730621 -0.06592568 -0.07643678
## hue         -0.296714564 -0.279235148  0.08522192  0.42777141 -0.17361452
## OD          -0.376167411 -0.164496193  0.16600459 -0.18412074 -0.10116099
## proline     -0.286752227  0.364902832 -0.12674592  0.23207086 -0.15786880
##                     PC6         PC7         PC8         PC9        PC10
## alcohol      0.21353865 -0.05639636  0.39613926 -0.50861912  0.21160473
## malic        0.53681385  0.42052391  0.06582674  0.07528304 -0.30907994
## ash          0.15447466 -0.14917061 -0.17026002  0.30769445 -0.02712539
## alk         -0.10082451 -0.28696914  0.42797018 -0.20044931  0.05279942
## Mg           0.03814394  0.32288330 -0.15636143 -0.27140257  0.06787022
## totphen     -0.08412230 -0.02792498 -0.40593409 -0.28603452 -0.32013135
## flavan      -0.01892002 -0.06068521 -0.18724536 -0.04957849 -0.16315051
## nonflavphen -0.25859401  0.59544729 -0.23328465 -0.19550132  0.21553507
## proantho    -0.53379539  0.37213935  0.36822675  0.20914487  0.13418390
## color       -0.41864414 -0.22771214 -0.03379692 -0.05621752 -0.29077518
## hue          0.10598274  0.23207564  0.43662362 -0.08582839 -0.52239889
## OD           0.26585107 -0.04476370 -0.07810789 -0.13722690  0.52370587
## proline      0.11972557  0.07680450  0.12002267  0.57578611  0.16211600
##                    PC11        PC12        PC13
## alcohol      0.22591696 -0.26628645  0.01496997
## malic       -0.07648554  0.12169604  0.02596375
## ash          0.49869142 -0.04962237 -0.14121803
## alk         -0.47931378 -0.05574287  0.09168285
## Mg          -0.07128891  0.06222011  0.05677422
## totphen     -0.30434119 -0.30388245 -0.46390791
## flavan       0.02569409 -0.04289883  0.83225706
## nonflavphen -0.11689586  0.04235219  0.11403985
## proantho     0.23736257 -0.09555303 -0.11691707
## color       -0.03183880  0.60422163 -0.01199280
## hue          0.04821201  0.25921400 -0.08988884
## OD          -0.04642330  0.60095872 -0.15671813
## proline     -0.53926983 -0.07940162  0.01444734</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the biplot which shows the loadings in the first 2 principal components</span></span>
<span id="cb140-2"><a href="multivariate-statistics-and-principle-components-analysis.html#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(wine.pca)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-49"></span>
<img src="Rportfolio-bookdown_files/figure-html/unnamed-chunk-49-1.png" alt="Biplot of the first two principal components for standardized data of three wine cultivars (1-59, 60-130, and 131-178), and loadings for variables alcohol, malic acid (malic), ash, alkalinity of ash (alk), magnesium (Mg), total phenol (totphen), flavonoids (flavan), nonflavanoid phenols (nonflavphen), proanthocyanins (proantho), color intensity (color), hue, OD280/OD315 of diluted wines (OD), and proline." width="672" />
<p class="caption">
Figure 8.3: Biplot of the first two principal components for standardized data of three wine cultivars (1-59, 60-130, and 131-178), and loadings for variables alcohol, malic acid (malic), ash, alkalinity of ash (alk), magnesium (Mg), total phenol (totphen), flavonoids (flavan), nonflavanoid phenols (nonflavphen), proanthocyanins (proantho), color intensity (color), hue, OD280/OD315 of diluted wines (OD), and proline.
</p>
</div>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the variable loadings to a .csv file</span></span>
<span id="cb141-2"><a href="multivariate-statistics-and-principle-components-analysis.html#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(wine.pca$rotation, file=&quot;wine_pca_loadings.csv&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the scores from PC1 and PC2 and add labels</span></span>
<span id="cb142-2"><a href="multivariate-statistics-and-principle-components-analysis.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wine.pca<span class="sc">$</span>x[,<span class="dv">1</span>], wine.pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">main=</span><span class="st">&quot;Scores from PC1 and PC2&quot;</span>)</span>
<span id="cb142-3"><a href="multivariate-statistics-and-principle-components-analysis.html#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(wine.pca<span class="sc">$</span>x[,<span class="dv">1</span>], wine.pca<span class="sc">$</span>x[,<span class="dv">2</span>], wine<span class="sc">$</span>cultivar,<span class="at">cex=</span><span class="fl">0.7</span>,<span class="at">pos=</span><span class="dv">4</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)   <span class="co">#add labels</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-50"></span>
<img src="Rportfolio-bookdown_files/figure-html/unnamed-chunk-50-1.png" alt="Scatterplot of principal component scores for standardized data of three wine cultivars (1, 2, 3). The first principal component scores are on the x axis, and the second principal component scores are on the y axis. Cultivar 1 is grouped in the upper left, with majority negative scores for principal component 1 and positive scores for principal component 2. Cultivar 2 is grouped with negative scores for principal component 2 and between -2 and 3 for principal component 1. Cultivar 3 is grouped in mostly positive scores for both components." width="672" />
<p class="caption">
Figure 8.4: Scatterplot of principal component scores for standardized data of three wine cultivars (1, 2, 3). The first principal component scores are on the x axis, and the second principal component scores are on the y axis. Cultivar 1 is grouped in the upper left, with majority negative scores for principal component 1 and positive scores for principal component 2. Cultivar 2 is grouped with negative scores for principal component 2 and between -2 and 3 for principal component 1. Cultivar 3 is grouped in mostly positive scores for both components.
</p>
</div>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the scores from PC3 and PC4 and add labels</span></span>
<span id="cb143-2"><a href="multivariate-statistics-and-principle-components-analysis.html#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wine.pca<span class="sc">$</span>x[,<span class="dv">3</span>], wine.pca<span class="sc">$</span>x[,<span class="dv">4</span>], <span class="at">main=</span><span class="st">&quot;Scores from PC3 and PC4&quot;</span>)</span>
<span id="cb143-3"><a href="multivariate-statistics-and-principle-components-analysis.html#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(wine.pca<span class="sc">$</span>x[,<span class="dv">3</span>], wine.pca<span class="sc">$</span>x[,<span class="dv">4</span>], wine<span class="sc">$</span>cultivar,<span class="at">cex=</span><span class="fl">0.7</span>,<span class="at">pos=</span><span class="dv">4</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)   <span class="co">#add labels</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-51"></span>
<img src="Rportfolio-bookdown_files/figure-html/unnamed-chunk-51-1.png" alt="Scatterplot of principal component scores for three wine cultivars (1, 2, 3). The third principal component scores are on the x axis, and the fourth principal component scores are on the y axis. All three cultivars primarily group in the center, with some outliers, mostly from cultivar 2." width="672" />
<p class="caption">
Figure 8.5: Scatterplot of principal component scores for three wine cultivars (1, 2, 3). The third principal component scores are on the x axis, and the fourth principal component scores are on the y axis. All three cultivars primarily group in the center, with some outliers, mostly from cultivar 2.
</p>
</div>
</div>
<div id="pca-on-raw-data" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> PCA on raw data<a href="multivariate-statistics-and-principle-components-analysis.html#pca-on-raw-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Perform PCA on the raw data</span></span>
<span id="cb144-2"><a href="multivariate-statistics-and-principle-components-analysis.html#cb144-2" aria-hidden="true" tabindex="-1"></a>wine.pca.raw <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(wine[,<span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>])</span>
<span id="cb144-3"><a href="multivariate-statistics-and-principle-components-analysis.html#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="multivariate-statistics-and-principle-components-analysis.html#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print summary of the Raw PCA</span></span>
<span id="cb144-5"><a href="multivariate-statistics-and-principle-components-analysis.html#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wine.pca.raw)</span></code></pre></div>
<pre><code>## Importance of components:
##                             PC1      PC2     PC3     PC4     PC5     PC6    PC7
## Standard deviation     314.9632 13.13527 3.07215 2.23409 1.10853 0.91710 0.5282
## Proportion of Variance   0.9981  0.00174 0.00009 0.00005 0.00001 0.00001 0.0000
## Cumulative Proportion    0.9981  0.99983 0.99992 0.99997 0.99998 0.99999 1.0000
##                           PC8    PC9   PC10   PC11   PC12    PC13
## Standard deviation     0.3891 0.3348 0.2678 0.1938 0.1452 0.09057
## Proportion of Variance 0.0000 0.0000 0.0000 0.0000 0.0000 0.00000
## Cumulative Proportion  1.0000 1.0000 1.0000 1.0000 1.0000 1.00000</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">screeplot</span>(wine.pca.raw)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-52"></span>
<img src="Rportfolio-bookdown_files/figure-html/unnamed-chunk-52-1.png" alt="Screeplot summary of variances in raw data." width="672" />
<p class="caption">
Figure 8.6: Screeplot summary of variances in raw data.
</p>
</div>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the loadings from the raw data</span></span>
<span id="cb147-2"><a href="multivariate-statistics-and-principle-components-analysis.html#cb147-2" aria-hidden="true" tabindex="-1"></a>wine.pca.raw<span class="sc">$</span>rotation</span></code></pre></div>
<pre><code>##                       PC1           PC2          PC3          PC4          PC5
## alcohol     -0.0016592647 -1.203406e-03 -0.016873809  0.141446778  0.020336977
## malic        0.0006810156 -2.154982e-03 -0.122003373  0.160389543 -0.612883454
## ash         -0.0001949057 -4.593693e-03 -0.051987430 -0.009772810  0.020175575
## alk          0.0046713006 -2.645039e-02 -0.938593003 -0.330965260  0.064352340
## Mg          -0.0178680075 -9.993442e-01  0.029780248 -0.005393756 -0.006149345
## totphen     -0.0009898297 -8.779622e-04  0.040484644 -0.074584656  0.315245063
## flavan      -0.0015672883  5.185073e-05  0.085443339 -0.169086724  0.524761088
## nonflavphen  0.0001230867  1.354479e-03 -0.013510780  0.010805561 -0.029647512
## proantho    -0.0006006078 -5.004400e-03  0.024659382 -0.050120952  0.251182529
## color       -0.0023271432 -1.510035e-02 -0.291398464  0.878893693  0.331747051
## hue         -0.0001713800  7.626731e-04  0.025977662 -0.060034945  0.051524077
## OD          -0.0007049316  3.495364e-03  0.070323969 -0.178200254  0.260639176
## proline     -0.9998229365  1.777381e-02 -0.004528682 -0.003112916 -0.002298569
##                      PC6          PC7           PC8           PC9          PC10
## alcohol     -0.194120104  0.923280337 -2.848207e-01 -8.660061e-02  2.245000e-03
## malic       -0.742472963 -0.150109941  6.467447e-02 -1.566214e-02  1.850935e-02
## ash         -0.041752912  0.045009549  1.493395e-01 -7.364985e-02  8.679965e-02
## alk          0.024065303  0.031526583 -1.515391e-02 -2.044578e-03 -3.554028e-03
## Mg           0.001923782  0.001797363  3.552212e-03  1.963668e-03  4.051542e-05
## totphen     -0.278716809 -0.020185710  1.772379e-01 -2.556729e-01 -8.471951e-01
## flavan      -0.433597955 -0.038868518  2.481166e-01 -3.783067e-01  5.201384e-01
## nonflavphen  0.021952834 -0.004665483 -6.497968e-03 -3.675204e-02 -3.771319e-02
## proantho    -0.241884488 -0.309799487 -8.704332e-01  5.152017e-02 -9.722752e-03
## color       -0.002739609 -0.112836514  8.128692e-02  9.902908e-02  2.314712e-02
## hue          0.023776167  0.030819813  2.951904e-03 -3.306512e-02  3.846983e-02
## OD          -0.288912753  0.101973518  1.867145e-01  8.737465e-01 -1.701708e-02
## proline      0.001212255 -0.001076189 -1.034095e-05  7.255852e-05 -4.926638e-05
##                      PC11          PC12          PC13
## alcohol     -0.0149715080 -1.565141e-02  8.029245e-03
## malic       -0.0231876506  6.729555e-02 -1.109039e-02
## ash          0.9540106426 -1.320630e-01 -1.736857e-01
## alk         -0.0528216953  5.393806e-03  1.939563e-03
## Mg          -0.0030248882  6.208885e-04  2.284536e-03
## totphen      0.0088016070  3.882903e-03 -2.669144e-02
## flavan      -0.1332046120 -3.748803e-02  6.959853e-02
## nonflavphen  0.1991789841  1.475524e-01  9.664662e-01
## proantho     0.1356214601 -1.311883e-02 -1.760357e-02
## color       -0.0098196717  5.035557e-02 -4.632943e-03
## hue          0.0975106606  9.755619e-01 -1.665508e-01
## OD           0.0284851062  1.163025e-02  4.419224e-02
## proline     -0.0002404522 -9.999951e-05  3.626701e-05</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="multivariate-statistics-and-principle-components-analysis.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the variable loadings to a .csv file</span></span>
<span id="cb149-2"><a href="multivariate-statistics-and-principle-components-analysis.html#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(wine.pca.raw$rotation, file=&quot;wine_pca_rawloadings.csv&quot;)</span></span>
<span id="cb149-3"><a href="multivariate-statistics-and-principle-components-analysis.html#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="multivariate-statistics-and-principle-components-analysis.html#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Biplot which shows the loadings in the first 2 principal components (raw data)</span></span>
<span id="cb149-5"><a href="multivariate-statistics-and-principle-components-analysis.html#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(wine.pca.raw)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-53"></span>
<img src="Rportfolio-bookdown_files/figure-html/unnamed-chunk-53-1.png" alt="Biplot of the first two principal components of unstandardized (raw) data for comparison." width="672" />
<p class="caption">
Figure 8.7: Biplot of the first two principal components of unstandardized (raw) data for comparison.
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-regressions-quadratic-fits-residuals-and-spatial.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Rportfolio-bookdown.pdf", "Rportfolio-bookdown.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
